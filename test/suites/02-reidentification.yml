# Venom Test Suite definition
# Check Venom documentation for more information : https://github.com/ovh/venom

name: run sigo reidentification
testcases:
  - name: reidentification
    steps:
      - script: |-
          cat > anonymized.json <<EOF
          {"original":0,"id":2,"x":3,"y":7,"z":"a"}
          {"original":1,"id":2,"x":3,"y":7,"z":""}
          {"original":0,"id":3,"x":3,"y":7,"z":"c"}
          {"original":1,"id":3,"x":4,"y":4,"z":""}
          {"original":1,"id":4,"x":2,"y":10,"z":""}
          {"original":0,"id":4,"x":3,"y":7,"z":"b"}
          {"original":1,"id":1,"x":5,"y":6,"z":""}
          {"original":0,"id":1,"x":7,"y":6.67,"z":"a"}
          {"original":0,"id":5,"x":7,"y":6.67,"z":"a"}
          {"original":1,"id":5,"x":8,"y":4,"z":""}
          {"original":0,"id":6,"x":7,"y":6.67,"z":"a"}
          {"original":1,"id":6,"x":8,"y":10,"z":""}
          {"original":1,"id":7,"x":3,"y":16,"z":""}
          {"original":0,"id":7,"x":4.33,"y":17.67,"z":"a"}
          {"original":0,"id":9,"x":4.33,"y":17.67,"z":"a"}
          {"original":1,"id":9,"x":6,"y":18,"z":""}
          {"original":1,"id":10,"x":4,"y":19,"z":""}
          {"original":0,"id":10,"x":4.33,"y":17.67,"z":"b"}
          {"original":1,"id":8,"x":7,"y":19,"z":""}
          {"original":0,"id":8,"x":8,"y":15.67,"z":"a"}
          {"original":1,"id":11,"x":7,"y":14,"z":""}
          {"original":0,"id":11,"x":8,"y":15.67,"z":"c"}
          {"original":0,"id":12,"x":8,"y":15.67,"z":"c"}
          {"original":1,"id":12,"x":10,"y":14,"z":""}
          {"original":1,"id":15,"x":11,"y":9,"z":""}
          {"original":0,"id":15,"x":12.33,"y":6,"z":"b"}
          {"original":1,"id":16,"x":12,"y":3,"z":""}
          {"original":0,"id":16,"x":12.33,"y":6,"z":"a"}
          {"original":0,"id":18,"x":12.33,"y":6,"z":"c"}
          {"original":1,"id":18,"x":14,"y":6,"z":""}
          {"original":1,"id":13,"x":15,"y":5,"z":""}
          {"original":0,"id":13,"x":16,"y":6,"z":"c"}
          {"original":1,"id":14,"x":15,"y":7,"z":""}
          {"original":0,"id":14,"x":16,"y":6,"z":"b"}
          {"original":0,"id":17,"x":16,"y":6,"z":"c"}
          {"original":1,"id":17,"x":18,"y":6,"z":""}
          {"original":0,"id":20,"x":16.67,"y":18.33,"z":"c"}
          {"original":1,"id":20,"x":18,"y":19,"z":""}
          {"original":0,"id":22,"x":16.67,"y":18.33,"z":"c"}
          {"original":1,"id":22,"x":18,"y":18,"z":""}
          {"original":1,"id":23,"x":14,"y":18,"z":""}
          {"original":0,"id":23,"x":16.67,"y":18.33,"z":"b"}
          {"original":0,"id":19,"x":19.67,"y":17.67,"z":"b"}
          {"original":1,"id":19,"x":20,"y":20,"z":""}
          {"original":0,"id":21,"x":19.67,"y":17.67,"z":"b"}
          {"original":1,"id":21,"x":20,"y":18,"z":""}
          {"original":1,"id":24,"x":19,"y":15,"z":""}
          {"original":0,"id":24,"x":19.67,"y":17.67,"z":"b"}
          EOF
      - script: |-
          sigo -q x,y -s original,z -a reidentification < anonymized.json
        assertions:
          - result.systemoutjson ShouldContainKey original
          - result.systemoutjson ShouldContainKey z
          - result.code ShouldEqual 0
