# Venom Test Suite definition
# Check Venom documentation for more information : https://github.com/ovh/venom

name: run sigo reidentification
testcases:
  - name: reidentification
    steps:
      - script: |-
          cat > anonymized.json <<EOF
          {"x":3,"y":7,"z":"b"}
          {"x":3,"y":7,"z":"a"}
          {"x":3,"y":7,"z":"c"}
          {"x":7,"y":6.67,"z":"a"}
          {"x":7,"y":6.67,"z":"a"}
          {"x":7,"y":6.67,"z":"a"}
          {"x":4.33,"y":17.67,"z":"a"}
          {"x":4.33,"y":17.67,"z":"b"}
          {"y":17.67,"z":"a","x":4.33}
          {"x":8,"y":15.67,"z":"c"}
          {"x":8,"y":15.67,"z":"a"}
          {"x":8,"y":15.67,"z":"c"}
          {"x":12.33,"y":6,"z":"b"}
          {"x":12.33,"y":6,"z":"a"}
          {"x":12.33,"y":6,"z":"c"}
          {"y":6,"z":"c","x":16}
          {"y":6,"z":"b","x":16}
          {"x":16,"y":6,"z":"c"}
          {"x":16.67,"y":18.33,"z":"b"}
          {"y":18.33,"z":"c","x":16.67}
          {"x":16.67,"y":18.33,"z":"c"}
          {"y":17.67,"z":"b","x":19.67}
          {"y":17.67,"z":"b","x":19.67}
          {"x":19.67,"y":17.67,"z":"b"}
          EOF
      - script: |-
          sigo reidentification -q x,y -s z --load-original=../../examples/re-identification/test1/data.json --load-anonymized=anonymized.json
        assertions:
          - result.systemoutjson ShouldContainKey sensitive
          - result.code ShouldEqual 0
      - script: rm -f anonymized.json
